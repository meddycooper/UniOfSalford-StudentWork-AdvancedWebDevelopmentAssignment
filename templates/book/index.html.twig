{% extends 'base.html.twig' %}

{% block title %}Books List{% endblock %}

{% block body %}
    <div class="container mt-4">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h1 class="display-5">Books List</h1>
            <a href="#" class="btn btn-primary">
                <i class="bi bi-plus-lg me-1"></i> Add New Book
            </a>
        </div>

        {% set dummyBooks = [
            {'title':'Sample Book 1','author':'Author A','genre':'Fiction','summary':'Lorem ipsum dolor sit amet, consectetur adipiscing elit.','pages':320,'averageRating':4,'reviewCount':12,'coverImage':null},
            {'title':'Sample Book 2','author':'Author B','genre':'Non-Fiction','summary':'Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.','pages':210,'averageRating':5,'reviewCount':8,'coverImage':null},
            {'title':'Sample Book 3','author':'Author C','genre':'Fantasy','summary':'Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip.','pages':450,'averageRating':null,'reviewCount':0,'coverImage':null}
        ] %}

        {% if dummyBooks is empty %}
            <div class="text-center my-5">
                <i class="bi bi-journal-x display-4 text-muted mb-3"></i>
                <p class="fs-5">No books available at the moment.</p>
                <a href="#" class="btn btn-outline-primary">
                    <i class="bi bi-plus-circle me-1"></i> Add Your First Book
                </a>
            </div>
        {% else %}
            <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
                {% for book in dummyBooks %}
                    <div class="col">
                        <div class="card h-100 border rounded-3 shadow-sm book-card">
                            {% if book.coverImage %}
                                <img src="{{ asset('uploads/covers/' ~ book.coverImage) }}" class="card-img-top" alt="Cover of {{ book.title }}">
                            {% endif %}
                            <div class="card-body d-flex flex-column">
                                <h5 class="card-title text-primary">{{ book.title }}</h5>
                                <p class="card-text mb-1"><strong>Author:</strong> {{ book.author }}</p>
                                <p class="card-text mb-1"><strong>Genre:</strong> {{ book.genre }}</p>
                                <p class="card-text small text-muted">{{ book.summary|slice(0, 100) ~ '...' }}</p>
                                <p class="card-text mt-2"><strong>Pages:</strong> {{ book.pages }}</p>
                                <p class="card-text mt-auto">
                                    <strong>Rating:</strong>
                                    {% if book.averageRating is not null %}
                                        <span class="text-warning">
                                            {% for i in 1..5 %}
                                                {% if i <= book.averageRating %}
                                                    <i class="bi bi-star-fill"></i>
                                                {% else %}
                                                    <i class="bi bi-star"></i>
                                                {% endif %}
                                            {% endfor %}
                                        </span>
                                        <small class="text-muted ms-2">
                                            ({{ book.reviewCount }} review{{ book.reviewCount == 1 ? '' : 's' }})
                                        </small>
                                    {% else %}
                                        <span class="text-muted">No ratings yet</span>
                                    {% endif %}
                                </p>
                            </div>
                            <div class="card-footer bg-transparent border-0 text-end">
                                <a href="#" class="btn btn-outline-primary btn-sm" data-bs-toggle="tooltip" title="View details">
                                    <i class="bi bi-eye me-1"></i> View Book
                                </a>
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>
        {% endif %}
    </div>

    <style>
        .book-card {
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }

        .book-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
            border-color: #dee2e6;
        }
    </style>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
            tooltipTriggerList.map(function (tooltipTriggerEl) {
                return new bootstrap.Tooltip(tooltipTriggerEl);
            });
        });
    </script>
{% endblock %}
