{% extends 'base.html.twig' %}

{% block title %}Admin Dashboard{% endblock %}

{% block body %}
    <div class="container mt-5">
        <div class="card shadow-sm rounded p-4">
            <h1 class="h3 mb-3 text-primary"><i class="bi bi-speedometer2 me-2"></i>Admin Dashboard</h1>
            <p class="mb-4">Welcome, admin! Use the links below to manage the application.</p>

            <div class="row g-3">
                <div class="col-md-6">
                    <a href="#" class="btn btn-outline-dark w-100 d-flex align-items-center justify-content-center">
                        <i class="bi bi-people me-2"></i>Manage Users
                    </a>
                </div>
                <div class="col-md-6">
                    <a href="#" class="btn btn-outline-dark w-100 d-flex align-items-center justify-content-center">
                        <i class="bi bi-book-half me-2"></i>Manage Books
                    </a>
                </div>
                <div class="col-md-6">
                    <a href="#" class="btn btn-outline-dark w-100 d-flex align-items-center justify-content-center">
                        <i class="bi bi-chat-dots me-1"></i>Manage Reviews
                    </a>
                </div>
            </div>
        </div>

        <div class="row mt-4">
            <!-- Most Reviewed Books -->
            <div class="col-md-4 mb-4">
                <div class="card shadow-sm">
                    <div class="card-header bg-info text-white">
                        Most Reviewed Books
                    </div>
                    <div class="card-body">
                        <canvas id="mostReviewedChart"></canvas>
                        <ul class="list-group list-group-flush mt-3">
                            {% for i in 1..3 %}
                                <li class="list-group-item d-flex justify-content-between align-items-center">
                                    Sample Book {{ i }}
                                    <span class="badge bg-primary rounded-pill">{{ 10 + i }}</span>
                                </li>
                            {% else %}
                                <li class="list-group-item text-center text-muted">No data</li>
                            {% endfor %}
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Top Rated Books -->
            <div class="col-md-4 mb-4">
                <div class="card shadow-sm">
                    <div class="card-header bg-success text-white">
                        Top Rated Books
                    </div>
                    <div class="card-body">
                        <canvas id="topRatedChart"></canvas>
                        <ul class="list-group list-group-flush mt-3">
                            {% for i in 1..3 %}
                                <li class="list-group-item d-flex justify-content-between align-items-center">
                                    Sample Book {{ i }}
                                    <span class="badge bg-success rounded-pill">{{ (4 + i*0.1)|number_format(2) }}</span>
                                </li>
                            {% else %}
                                <li class="list-group-item text-center text-muted">No data</li>
                            {% endfor %}
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Most Active Users -->
            <div class="col-md-4 mb-4">
                <div class="card shadow-sm">
                    <div class="card-header bg-warning text-dark">
                        Most Active Users
                    </div>
                    <div class="card-body">
                        <canvas id="mostActiveUsersChart"></canvas>
                        <ul class="list-group list-group-flush mt-3">
                            {% for i in 1..3 %}
                                <li class="list-group-item d-flex justify-content-between align-items-center">
                                    user{{ i }}
                                    <span class="badge bg-warning text-dark rounded-pill">{{ 5 + i }}</span>
                                </li>
                            {% else %}
                                <li class="list-group-item text-center text-muted">No data</li>
                            {% endfor %}
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        const createBarChart = (ctxId, labels, data, bgColor, maxY = null) => {
            new Chart(document.getElementById(ctxId).getContext('2d'), {
                type: 'bar',
                data: { labels, datasets: [{ label: '', data, backgroundColor: bgColor }] },
                options: {
                    responsive: true,
                    scales: { y: { beginAtZero: true, max: maxY, precision: 0 } }
                }
            });
        }

        // Placeholder data
        const mostReviewedLabels = ['Sample Book 1','Sample Book 2','Sample Book 3'];
        const mostReviewedData = [11,12,13];
        const topRatedLabels = ['Sample Book 1','Sample Book 2','Sample Book 3'];
        const topRatedData = [4.1,4.2,4.3];
        const mostActiveUsersLabels = ['user1','user2','user3'];
        const mostActiveUsersData = [6,7,8];

        createBarChart('mostReviewedChart', mostReviewedLabels, mostReviewedData, 'rgba(13,110,253,0.7)');
        createBarChart('topRatedChart', topRatedLabels, topRatedData, 'rgba(25,135,84,0.7)', 5);
        createBarChart('mostActiveUsersChart', mostActiveUsersLabels, mostActiveUsersData, 'rgba(255,193,7,0.7)');
    </script>
{% endblock %}
